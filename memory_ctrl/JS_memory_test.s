[bits 32]
GLOBAL _JS_Memory_Test;int JS_Memory_Test(int step)

PART1 	EQU		0XAA55AA55
PART2	EQU		0X55AA55AA
MASK	EQU		0XFFFFFFFF
START	EQU		0X00100001
_JS_Memory_Test:
	MOV		EBX,[ESP+4]
	PUSH	ESI
	XOR		EAX,EAX
	MOV		ESI,START
memory_test:
	MOV		EDX,[ESI]
	
	MOV		DWORD[ESI],PART1
	XOR		DWORD[ESI],MASK
	CMP		DWORD[ESI],PART2
	JNE		RETURN
	
	MOV		DWORD[ESI],PART2
	XOR		DWORD[ESI],MASK
	CMP		DWORD[ESI],PART1
	JNE		RETURN
	
	MOV		[ESI],EDX
	
	ADD		ESI,EBX
	CMP		ESI,0XFF000000
	JAE		RETURN
	
	
	JMP		memory_test
RETURN:
	MOV		EAX,ESI
	POP		ESI
	RET
